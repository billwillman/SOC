local CSharpEventContainer = require("_Common.CSharpEventContainer")

local PlayerController = _MOE.class("PlayerController", CSharpEventContainer)

function PlayerController:Ctor(playerController, binder)
    self.PlayerController = playerController
    self.Binder = binder

    local EventType = _MOE.LuaEvent_MonoEventType
    self.Binder:RegisterLuaEvent(EventType.Destroyed:GetHashCode(), self.OnDestroy)

    self:RegsterCSharpEvent(self.PlayerController, "onNetworkSpawn", self.OnNetworkSpawn)
    self:RegsterCSharpEvent(self.PlayerController, "onNetworkDespawn", self.OnNetworkDespawn)
end

local function GetClientId(self)
    if self.PlayerController then
        return self.PlayerController.OwnerClientId
    end
end

function PlayerController:OnNetworkSpawn()
    _MOE.Logger.LogFormat("[PlayerController] OnNetworkSpawn(ClientId:{0:D})", self:GetClientId())
    self.ClientId = GetClientId()
end

function PlayerController:GetClientId()
    return self.ClientId
end

function PlayerController:OnNetworkDespawn()
    _MOE.Logger.LogFormat("[PlayerController] OnNetworkDespawn(ClientId:{0:D})", self:GetClientId())
end

function PlayerController:OnDestroy()
    self.PlayerController = nil
    self.Binder = nil
end

return PlayerController
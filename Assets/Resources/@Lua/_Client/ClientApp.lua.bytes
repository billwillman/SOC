local BaseAppClass = require("_Common.BaseApp")

local ClientApp = _MOE.class("ClientApp", BaseAppClass)

local function CreateUIRoot()
    local root = _MOE.ResourceManager:CreateGameObject("Resources/UI/UI Root.prefab")
    if root then
        root.name = "UI Root"
        root.transform:SetParent(_MOE.GameStartTransform, false)
    end
end

function ClientApp:OnInit()
    CreateUIRoot()
    _MOE.BaseViewClass = require("_Common.BaseView")
    self.TimerManager = self:GetModel("TimerManager")
    _MOE.TimerManager = self.TimerManager
    _MOE.UIManager = require("_Client.UIManager").New()
    self:RegisterModel("_Client.Models.NetClientModel")
    self:RegisterModel("_Client.Models.LoginModel", false)
    self:RegisterModel("_Common.TimerManager", false)
end

function ClientApp:OnQuit()
    _MOE.UIManager:FreeAllWindow()
    _MOE.NetManager:Disconnect()
end

function ClientApp:OnUpdate(deltaTime)
    if self.TimerManager and self.TimerManager.OnUpdate then
        self.TimerManager:OnUpdate(deltaTime)
    end
end

return ClientApp